视频下载管理器 (Video Download Manager) 使用说明书
Release_version_1.1

软件功能概述

该软件是一款基于 yt-dlp 的图形化界面下载器，支持以下功能：
	1.	视频下载：可选择视频分辨率并下载高质量的视频文件。
	2.	音频下载：支持仅下载音频并自动转换为 MP3 格式。
	3.	字幕下载：可选择指定语言的字幕并下载，支持多种字幕格式转换（如 SRT, VTT, ASS）。
	4.	界面优化：支持 DPI 感知与自适应缩放，所有界面字体采用微软雅黑，视觉效果清晰美观。

运行环境
	•	操作系统：Windows 10/11
	•	运行库：
	•	Python 3.9 或以上版本
	•	tkinter 图形库（内置于 Python）
	•	ttkthemes 用于优化界面风格
	•	依赖库：yt-dlp, threading, os, ctypes
	•	必要文件：
	•	ffmpeg.exe，需要放置在软件所在目录下。

功能与操作指南

1. 软件主界面

主界面布局如下：
	•	输入区域：
	•	视频 URL：输入要下载的视频链接。
	•	下载目录：选择保存视频、音频及字幕的文件夹。
	•	浏览按钮：通过弹出文件夹选择窗口指定下载路径。
	•	按钮区域：
	•	扫描链接：获取指定链接的视频信息。
	•	扫描字幕：扫描可用字幕语言。
	•	开始下载：根据选择的设置开始下载任务。
	•	格式选择区域：
	•	分辨率：选择所需的视频分辨率。
	•	字幕语言：选择要下载的字幕语言及是否为自动生成字幕。
	•	字幕格式：选择字幕的导出格式（SRT、VTT、ASS）。
	•	选项区域：
	•	只下载音频 (MP3)：勾选后只下载音频并自动转换为 MP3。
	•	下载字幕：勾选后启用字幕下载功能。
	•	日志区域：实时显示下载进度和结果信息，包括文件路径和文件大小。
	•	进度条：实时显示下载的百分比进度。

2. 软件功能操作

1) 视频下载
	1.	在 视频 URL 输入框中输入目标视频链接（如 YouTube 链接）。
	2.	点击 扫描链接：
	•	软件会显示可用分辨率选项，如 1920p, 1080p, 720p 等。
	•	若未检测到分辨率，日志区域会提示“未找到可用的视频分辨率格式”。
	3.	从 选择分辨率 下拉框中选择所需的分辨率。
	4.	确保 只下载音频 (MP3) 未勾选。
	5.	点击 开始下载：
	•	视频和音频会自动合并为 .mp4 格式，并保存至指定目录。

2) 音频下载
	1.	在 视频 URL 输入框中输入目标视频链接。
	2.	勾选 只下载音频 (MP3)，无需选择分辨率。
	3.	点击 开始下载：
	•	软件会下载音频并自动转换为 MP3 格式，保存至指定目录。

3) 字幕下载
	1.	勾选 下载字幕。
	2.	点击 扫描字幕：
	•	在 选择字幕语言 下拉框中会显示可用字幕语言（如 English, 简体中文, 日语）。
	•	若无可用字幕，日志区域会提示“未找到指定语言的字幕”。
	3.	从 选择字幕语言 下拉框中选择字幕语言。
	4.	从 字幕格式 下拉框中选择所需的字幕格式（如 SRT）。
	5.	点击 开始下载：
	•	下载的视频文件会附带对应的字幕文件，字幕文件名与视频文件一致。

4) 下载进度与结果
	•	下载过程中，进度条会实时显示下载进度。
	•	下载完成后：
	•	日志区域显示文件的保存路径和大小。
	•	示例：文件路径: C:\path\to\video.mp4 文件大小: 531.40 MB

注意事项
	1.	DPI 缩放问题：
	•	软件已支持 Windows 系统的 DPI 感知功能，若界面仍然模糊，请确保系统显示设置中的缩放比例为常见值（如 100%、125%、150%）。
	•	在源码中通过 ctypes 调用 Windows API 设置 SetProcessDpiAwareness(1) 和 scaling 调整缩放。
	2.	分辨率选择限制：
	•	若选择了不存在的分辨率，软件会自动选择最接近的分辨率进行下载。
	3.	字幕支持语言：
	•	当前仅支持以下语言字幕：简体中文 (Chinese Simplified)、英语 (English)、日语 (Japanese)、俄语 (Russian)、德语 (German)、法语 (French)。
	4.	ffmpeg.exe 依赖：
	•	请将 ffmpeg.exe 文件放置于软件所在的根目录，否则字幕转换和音视频合并功能将无法正常运行。
	5.	多线程下载：
	•	软件支持多线程操作，避免界面卡顿，但请勿同时进行多个下载任务，以免影响下载速度。

问题排查
	1.	视频无法下载：
	•	检查网络连接是否稳定。
	•	检查视频 URL 是否可访问，某些受版权保护的视频可能无法下载。
	2.	字幕语言不可用：
	•	检查字幕是否为 YouTube 提供的原生字幕或自动生成字幕。
	•	使用 扫描字幕 功能获取最新的字幕信息。
	3.	音频转换失败：
	•	确保 ffmpeg.exe 已正确配置在根目录。
	•	检查日志输出的错误信息。

软件更新计划
	•	未来功能：
	•	添加批量下载功能。
	•	支持更多视频网站。
	•	优化字幕语言筛选功能。
	•	提供更加详细的错误日志。

作者声明

本软件基于 yt-dlp 开源库开发，仅供学习与研究使用，请勿用于非法用途。

版权所有：2024